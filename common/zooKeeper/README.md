# ZooKeeper
분산 시스템을 위한 코디네이터

분산 시스템을 설계하다보면은 분산된 시스템의 정보 공유, 서버들의 상태 체크, 분산 서버든간의 동기화를 위한 락을 처리해야한다.

이러한 문제를 해결하는 대표적인 시스템이 Apache ZooKeeper이다.

ZooKeeper의 대표적인 기능은 분산 시스템내에 중요한 상태 정보나 설정 정보등을 유지해야한다.

ZooKeeper는 디렉토리 구조기반으로 znode라는 데이터 객체를 제공하고

Key-Value식으로 객체에 데이터를 넣고 빼는 기능만 제공한다.

## Node의 종류
1. Persistent Node : 노드에 테이터를 저장하면 일부러 삭제하지않는 이상 삭제되지 않는 노드 
2. Ephemeral Node : 노드를 생성한 클라이언트의 세션이 연결되어 있는 경우만 유효한 노드, 클라이언트 연결이 끊어지는 순간 삭제된다.
3. Sequence Node : 노드를 생성할때 자동으로 sequence번호가 붙는 노드. 주로 분산락을 구현할때 사용한다.

### Watcher
ZooKeeper 클라이언트가 특정 node에 watcher를 걸어놓으면 node가 변경되었을때 callback호출을 받게된다.

## ZooKeeper의 용도
클러스터 구성원 간의 데이터 공유나, 설정변경, 분산 락 등에 활용되는 시퀀스 노드를 제공할수 있다.

1. 설정관리 -> 클러스터의 하나의 설정이 변경되면 다른 클러스터들이 모두 설정이 변경됨을 알수있다.
    * 가장 일반적인 용도로 각 서버들의 설정정보를 저장하는 저장소로 사용된다.
    * Watch 기능을 이용하면 설정 정보가 변경될경우 각 서버로 알려서 바로 반영할수 있다.
2. 분산 클러스터 관리
    * Ephemeral Node는 Zookeeper 클라이언트가 살아있는 경우만 유효하기 때문에, 클러스터내의 서버가 Ephemeral Node를 등록한다면 살아있는 서버들만 Ephemeral Node에 유지된다.
    * 조금 더 발전하면 서버 구조가 master/slave 일때 master서버가 죽으면 , slave서버들 중 master 서버를 선출 가능하다.
3. 글로벌 락 
    * 여러대의 서버로 구성되어있을때 분산 서버가 공유자원에 접근했을때 Synchronized처럼 lock을 걸수있다.
