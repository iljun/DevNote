# Sharding

## 수평분할(Horizontal Partitioning)
수평분할이란 스키마가 같은 데이터를 두개 이상의 테이블에 나누어 저장하는것 

같은 스키마이지만 어느 기준에 따라 다른 테이블에 저장하는것이다.

수평분할을 하는 이유는 인덱스의 크기를 줄이고, 작업 동시성을 늘리기 위해서이다.

수평분할은 하나의 데이터베이스 안에서 이루어진다.

## 샤딩(Sharding)
샤딩은 물리적으로 다른 데이터베이스에 데이터를 수평분할 방식으로 분산 저장하고 조회하는 방법을 의미한다.

여러 데이터베이스를 대상으로 작업해야 하기 떄문에 경우에따라서 JOIN 연산등의 제약이 생길수 있다.

예전에 샤딩은 애플리케이션 서버 레벨에서 구현했지만 최근에는 플랫폼 차원에서 제공하려는 시도가 많다.

Hibernate Shards나 CUBRID SHARD, Spock Proxy, GIzzard는 애플리케이션 서버에서 작동하는 방식이며 
 
nStore, MongoDB는 데이터베이스 자체에서 샤딩기능을 제공하기도 한다.

#### 한계
###### range-based sharding
특정 ID값을 기준으로 ID범위에 따라 샤드를 나누는 방식이다.

ID값이 증가하는 추이를 보고서 새로운 샤드 추가가 쉽다는 장점이 있지만,

디스크 사용량이나 쿼리 처리량의 밸런스가 많이 안맞는 경우가 발생하기도 한다.

###### modulus-based sharding
id값 % 샤드 갯수 의 결과값으로 샤드 위치를 결정하는 방법이다.

Range방식에 비해 사용 밸런스는 잘 맞지만 이 방식은 샤드 추가가 어렵다.

샤드를 확장할시 기존의 각 샤드마다 데이터의 재배치가 필요하다.